<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GreenRush — Weed Coin Collective</title>
  <style>
    /* ===== Base ===== */
    :root {
      --bg-dark: #050505;
      --bg-card: rgba(20, 20, 20, 0.6);
      --text-main: #F3F0E6;
      --text-muted: rgba(243, 240, 230, 0.6);
      --accent-primary: #00E676; /* Vibrant Green */
      --accent-secondary: #2E7D32;
      --accent-glow: rgba(0, 230, 118, 0.4);
      --border-light: rgba(255, 255, 255, 0.08);
      --glass-blur: blur(12px);
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background-color: var(--bg-dark);
      background-image: 
        radial-gradient(circle at 50% -20%, #1a3a2a 0%, #050505 45%),
        radial-gradient(circle at 85% 60%, rgba(46, 125, 50, 0.08) 0%, transparent 30%);
      background-attachment: fixed;
      color: var(--text-main);
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.6;
    }

    a {
      text-decoration: none;
      color: inherit;
      transition: color 0.2s ease;
    }

    /* ===== Layout ===== */
    .gr-header {
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 6vw;
      border-bottom: 1px solid var(--border-light);
      background: rgba(5, 5, 5, 0.8);
      backdrop-filter: blur(16px);
    }

    .logo-text {
      font-weight: 900;
      letter-spacing: 0.1em;
      font-size: 1.2rem;
      background: linear-gradient(135deg, #fff 0%, var(--accent-primary) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .nav-links {
      display: flex;
      gap: 2rem;
      background: rgba(255,255,255,0.03);
      padding: 0.5rem 1.5rem;
      border-radius: 999px;
      border: 1px solid var(--border-light);
    }

    .nav-link {
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 500;
      opacity: 0.6;
      cursor: pointer;
    }

    .nav-link:hover,
    .nav-link.active {
      opacity: 1;
      color: var(--accent-primary);
    }

    main {
      padding: 4rem 8vw 6rem;
      max-width: 1280px;
      margin: 0 auto;
    }

    section {
      scroll-margin-top: 80px;
    }

    /* ===== Hero ===== */

    .hero {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
      align-items: center;
      gap: 4rem;
      margin-bottom: 6rem;
      position: relative;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: -20%;
      right: -10%;
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(0, 230, 118, 0.15) 0%, transparent 70%);
      filter: blur(60px);
      z-index: -1;
      pointer-events: none;
    }

    .hero-title {
      font-size: 4rem;
      line-height: 1.1;
      letter-spacing: -0.02em;
      font-weight: 800;
      margin-bottom: 1.5rem;
      background: linear-gradient(180deg, #fff 0%, #e0e0e0 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .hero-title.small {
      font-size: 2.5rem;
    }

    .hero-subtitle {
      font-size: 1.1rem;
      color: var(--text-muted);
      max-width: 32rem;
      margin-bottom: 2.5rem;
    }

    .hero-actions {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .hero-right {
      display: flex;
      justify-content: center;
      position: relative;
    }

    .mascot-card {
      /* Blend with background - removed card styling */
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      padding: 0;
      border: none;
      box-shadow: none;
    }
    
    .mascot-card::after {
      display: none;
    }

    .mascot-img {
      width: 380px;
      max-width: 100%;
      display: block;
      filter: drop-shadow(0 10px 20px rgba(0,0,0,0.5));
      transition: transform 0.3s ease;
    }
    
    .mascot-card:hover .mascot-img {
      transform: scale(1.02) rotate(-2deg);
    }

    /* logo gallery removed (was here) */

    /* small toast for copy confirmation */
    #gr-toast {
      position: fixed;
      right: 24px;
      bottom: 24px;
      background: #1a1a1a;
      border: 1px solid var(--accent-primary);
      color: var(--accent-primary);
      padding: 0.8rem 1.2rem;
      border-radius: 12px;
      font-weight: 600;
      font-size: 0.9rem;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      pointer-events: none;
      z-index: 200;
    }

    #gr-toast.show { opacity: 1; transform: translateY(0); pointer-events: auto }

    /* ===== Buttons ===== */

    .btn-primary {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.9rem 2rem;
      border-radius: 12px;
      border: none;
      background: var(--accent-primary);
      color: #000;
      font-weight: 700;
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 0 0 rgba(0, 230, 118, 0);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px var(--accent-glow);
      background: #00ff85;
    }

    .btn-primary.full {
      width: 100%;
    }

    .btn-ghost {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.9rem 2rem;
      border-radius: 12px;
      border: 1px solid var(--border-light);
      background: rgba(255,255,255,0.03);
      color: var(--text-main);
      font-size: 0.95rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-ghost:hover {
      border-color: var(--accent-primary);
      background: rgba(0, 230, 118, 0.05);
      color: var(--accent-primary);
    }

    /* Ensure form elements and code inherit the page's light text color */
    input, select, textarea, code {
      color: var(--text-main);
      font-family: inherit;
    }

    input::placeholder, textarea::placeholder {
      color: var(--text-muted);
    }

    /* Header actions: keep nav and connect button aligned */
    .header-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .header-connect {
      padding: .6rem 1.2rem;
      border-radius: 10px;
      font-size: .9rem;
      font-weight: 600;
      background: rgba(46, 125, 50, 0.2);
      color: var(--accent-primary) !important;
      border: 1px solid rgba(46, 125, 50, 0.5) !important;
      transition: all 0.2s ease;
    }
    
    .header-connect:hover {
      background: rgba(46, 125, 50, 0.4);
      box-shadow: 0 0 15px rgba(46, 125, 50, 0.3);
    }

    /* Product-specific buy button: smaller, cleaner green */
    .product-buy {
      padding: 0.6rem 1.2rem;
      border-radius: 8px;
      background: var(--accent-primary);
      color: #000;
      border: none;
      font-weight: 700;
      font-size: 0.85rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      min-width: 100%;
      justify-content: center;
      margin-top: auto;
      transition: all 0.2s;
    }

    .product-buy:hover {
      background: #00ff85;
      box-shadow: 0 5px 15px var(--accent-glow);
      transform: translateY(-1px);
    }

    /* ===== Sections ===== */

    .section-title {
      font-size: 1.8rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 2rem;
      font-weight: 800;
      color: #fff;
    }

    .section-header-row {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .section-link {
      font-size: 0.9rem;
      color: var(--accent-primary);
      font-weight: 600;
      transition: opacity 0.2s;
    }

    .section-link:hover {
      opacity: 0.8;
    }

    .why {
      margin-bottom: 6rem;
    }

    .why-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
    }

    .why-card {
      border-radius: 1.5rem;
      padding: 2rem;
      background: var(--bg-card);
      backdrop-filter: var(--glass-blur);
      border: 1px solid var(--border-light);
      transition: transform 0.3s ease, border-color 0.3s ease;
    }

    .why-card:hover {
      transform: translateY(-5px);
      border-color: rgba(0, 230, 118, 0.3);
    }

    .why-card h3 {
      margin-bottom: 1rem;
      font-size: 1.2rem;
      color: #fff;
    }

    .why-card p {
      font-size: 0.95rem;
      color: var(--text-muted);
      line-height: 1.6;
    }

    /* ===== Products ===== */

    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 2rem;
    }

    .product-card {
      border-radius: 1.5rem;
      border: 1px solid var(--border-light);
      background: var(--bg-card);
      backdrop-filter: var(--glass-blur);
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
      transition: all 0.3s ease;
      position: relative;
    }

    .product-card:hover {
      transform: translateY(-8px);
      border-color: var(--accent-primary);
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }

    .product-name {
      font-size: 1.2rem;
      font-weight: 700;
      color: #fff;
    }

    .product-desc {
      font-size: 0.9rem;
      color: var(--text-muted);
      line-height: 1.5;
      flex-grow: 1;
    }

    .product-price {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent-primary);
      margin-top: 0.5rem;
    }

    .product-meta {
      font-size: 0.8rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Badges */
    .product-badge {
      align-self: flex-start;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      padding: 0.3rem 0.8rem;
      border-radius: 6px;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .product-badge.common {
      background: rgba(255, 255, 255, 0.1);
      color: #ccc;
    }

    .product-badge.uncommon {
      background: rgba(46, 125, 50, 0.2);
      color: #81c784;
      border: 1px solid rgba(46, 125, 50, 0.3);
    }

    .product-badge.rare {
      background: rgba(0, 230, 118, 0.1);
      color: var(--accent-primary);
      border: 1px solid var(--accent-primary);
      box-shadow: 0 0 10px rgba(0, 230, 118, 0.2);
    }

    .product-badge.epic {
      background: rgba(155, 123, 255, 0.15);
      color: #b39ddb;
      border: 1px solid rgba(155, 123, 255, 0.3);
      box-shadow: 0 0 15px rgba(155, 123, 255, 0.2);
    }

    .product-badge.legendary {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 160, 0, 0.1));
      color: #ffd54f;
      border: 1px solid rgba(255, 215, 0, 0.3);
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
    }

    /* ===== Shop ===== */

    .shop-hero {
      margin-bottom: 3rem;
      text-align: center;
    }
    
    .shop-hero .hero-subtitle {
      margin: 0 auto;
    }

    .filters {
      margin-bottom: 3rem;
      display: flex;
      justify-content: center;
    }

    .filters-inner {
      display: flex;
      flex-wrap: wrap;
      gap: 0.8rem;
      align-items: center;
      background: rgba(255,255,255,0.03);
      padding: 0.5rem;
      border-radius: 1rem;
      border: 1px solid var(--border-light);
    }

    .filter-label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      margin-left: 0.5rem;
      margin-right: 0.5rem;
    }

    .filter-pill {
      border-radius: 0.8rem;
      border: 1px solid transparent;
      padding: 0.5rem 1.2rem;
      font-size: 0.85rem;
      background: transparent;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.2s;
    }

    .filter-pill.active,
    .filter-pill:hover {
      background: rgba(255,255,255,0.05);
      color: #fff;
      border-color: var(--border-light);
    }
    
    .filter-pill.active {
      background: var(--accent-primary);
      color: #000;
      font-weight: 600;
    }

    .shop-grid-section {
      margin-bottom: 6rem;
    }

    /* ===== Footer ===== */

    .gr-footer {
      border-top: 1px solid var(--border-light);
      padding: 2rem 6vw;
      font-size: 0.9rem;
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      color: var(--text-muted);
      background: #020202;
    }

    /* ===== Responsive ===== */

    @media (max-width: 800px) {
      .hero {
        grid-template-columns: 1fr;
        gap: 3rem;
        text-align: center;
      }
      
      .hero::before {
        right: 50%;
        transform: translateX(50%);
        top: -10%;
      }

      .hero-right {
        justify-content: center;
      }
      
      .hero-actions {
        justify-content: center;
      }
      
      .hero-subtitle {
        margin-left: auto;
        margin-right: auto;
      }

      main {
        padding: 2rem 5vw 4rem;
      }

      .gr-header,
      .gr-footer {
        padding-inline: 5vw;
      }
    }
  </style>
</head>
<body>
  <header class="gr-header">
    <div class="logo-wrap">
      <span class="logo-text">GREENRUSH</span>
    </div>
      <div class="header-actions">
        <nav class="nav-links">
          <a href="#home" class="nav-link active">Home</a>
          <a href="#token-info" class="nav-link">Token</a>
          <a href="#shop" class="nav-link">Shop</a>
        </nav>
        <button id="connect-wallet-btn" class="header-connect" aria-label="Connect Phantom Wallet">Connect Wallet</button>
      </div>
  </header>
  <main>
    <!-- HOME SECTION -->
    <section id="home">
      <div class="hero">
        <div class="hero-left">
          <h1 class="hero-title">GREENRUSH</h1>
          <p class="hero-subtitle">
            The chillest memecoin collective. Collect rare weed coins,
            flex your stash, and trade using the GreenRush supply.
          </p>
          <div class="hero-actions">
            <a href="#shop" class="btn-primary">Enter Shop</a>
            <button class="btn-ghost" onclick="document.querySelector('#featured').scrollIntoView({behavior:'smooth'})">
              View Collection
            </button>
          </div>

          <!-- logo gallery removed per request -->
        </div>
        <div class="hero-right">
          <div class="mascot-card">
            <!-- restored mascot PNG (original) -->
            <img src="assets/mascot.png" alt="GreenRush Mascot" class="mascot-img">
          </div>
        </div>
      </div>

      <!-- WHY SECTION -->
      <section class="why">
        <h2 class="section-title">Why GreenRush?</h2>
        <div class="why-grid">
          <article class="why-card">
            <h3>Community First</h3>
            <p>
              Built around holders, not hype. The supply powers the shop,
              drops, and collector rewards.
            </p>
          </article>
          <article class="why-card">
            <h3>Meme & Streetwear</h3>
            <p>
              High-quality art, bold typography, and a mascot that actually
              looks clean on a hoodie or cap.
            </p>
          </article>
          <article class="why-card">
            <h3>Collectible Coins</h3>
            <p>
              Different “strains” of coins with rarity tiers, all purchasable
              using the GreenRush supply.
            </p>
          </article>
        </div>
      </section>

      <!-- FEATURED PRODUCTS PREVIEW -->
      <section class="featured" id="featured">
        <div class="section-header-row">
          <h2 class="section-title">Featured Coins</h2>
          <a href="#shop" class="section-link">View Full Shop →</a>
        </div>
        <div class="product-grid">
          <!-- Product 1 -->
          <article class="product-card">
            <div class="product-badge common">Common</div>
            <h3 class="product-name">Classic Bud Coin</h3>
            <p class="product-desc">
              The OG GreenRush coin. Muted green body with a clean mascot imprint.
            </p>
            <p class="product-price">Price: 420 GRUSH</p>
          </article>
          <!-- Product 2 -->
          <article class="product-card">
            <div class="product-badge uncommon">Uncommon</div>
            <h3 class="product-name">Silver Rush Coin</h3>
            <p class="product-desc">
              Metallic-silver finish with streetwear engraving and shades-on mascot.
            </p>
            <p class="product-price">Price: 1,200 GRUSH</p>
          </article>
          <!-- Product 3 -->
          <article class="product-card">
            <div class="product-badge rare">Rare</div>
            <h3 class="product-name">Midnight Kush Coin</h3>
            <p class="product-desc">
              Matte-black coin with glow-green lines. Built for late-night flex.
            </p>
            <p class="product-price">Price: 3,500 GRUSH</p>
          </article>
        </div>
      </section>
    </section>

    <!-- TOKEN INFO SECTION -->
    <section id="token-info" style="margin-bottom: 6rem;">
      <div class="section-header-row">
        <h2 class="section-title">Token Info</h2>
        <div style="display:flex; align-items:center; gap:1rem; background:rgba(255,255,255,0.05); padding:0.5rem 1rem; border-radius:12px; border:1px solid var(--border-light);">
          <span style="font-size:0.9rem; color:var(--text-muted);">Contract:</span>
          <code id="gr-contract" style="color:#fff; font-family:monospace;">0x...YOURADDR</code>
          <button id="gr-copy-btn" class="btn-ghost" style="padding:0.4rem 0.8rem; font-size:0.75rem; margin-left:0.5rem; border-radius:8px;">Copy</button>
        </div>
      </div>
      <div class="why-grid">
        <div class="why-card">
          <h3 style="color:var(--accent-primary)">Total Supply</h3>
          <p style="font-size:1.5rem; font-weight:700; color:#fff;">1,000,000,000</p>
          <p style="font-size:0.8rem; opacity:0.6">GRUSH</p>
        </div>
        <div class="why-card">
          <h3 style="color:var(--accent-primary)">Circulating</h3>
          <p style="font-size:1.5rem; font-weight:700; color:#fff;">420,000,000</p>
          <p style="font-size:0.8rem; opacity:0.6">GRUSH</p>
        </div>
        <div class="why-card">
          <h3 style="color:var(--accent-primary)">Market Cap</h3>
          <p style="font-size:1.5rem; font-weight:700; color:#fff;">$---</p>
          <p style="font-size:0.8rem; opacity:0.6">Est. Value</p>
        </div>
        <div class="why-card" style="display:flex; align-items:center; justify-content:center;">
          <a class="btn-primary full" href="#shop">Buy in Shop</a>
        </div>
      </div>
    </section>

    <!-- SHOP SECTION -->
    <section id="shop">
      <section class="shop-hero">
        <div>
          <h1 class="hero-title small">GreenRush Shop</h1>
          <p class="hero-subtitle">
            Pick your strain of wealth. All items are purchased with the
            GreenRush supply (GRUSH).
          </p>
        </div>
      </section>

      <!-- FILTER BAR (visual only) -->
      <section class="filters">
        <div class="filters-inner">
          <span class="filter-label">Sort by:</span>
          <button class="filter-pill active">Most Popular</button>
          <button class="filter-pill">Highest Rarity</button>
          <button class="filter-pill">New Drops</button>
          <button class="filter-pill">Low Supply</button>
        </div>
      </section>

      <!-- PRODUCT GRID -->
      <section class="shop-grid-section">
        <div class="product-grid">
          <!-- Common -->
          <article class="product-card">
            <div class="product-badge common">Common</div>
            <h3 class="product-name">Classic Bud Coin</h3>
            <p class="product-desc">
              Clean muted-green coin with the GreenRush bud stamped in the center.
            </p>
            <p class="product-meta">Supply: 200,000 • Type: Base</p>
            <p class="product-price">420 GRUSH</p>
            <button class="btn-primary product-buy">Buy</button>
          </article>

          <!-- Uncommon -->
          <article class="product-card">
            <div class="product-badge uncommon">Uncommon</div>
            <h3 class="product-name">Silver Rush Coin</h3>
            <p class="product-desc">
              Metallic-silver body, sharp engravings, reflective details.
            </p>
            <p class="product-meta">Supply: 80,000 • Type: Street</p>
            <p class="product-price">1,200 GRUSH</p>
            <button class="btn-primary product-buy">Buy</button>
          </article>

          <!-- Rare -->
          <article class="product-card">
            <div class="product-badge rare">Rare</div>
            <h3 class="product-name">Midnight Kush Coin</h3>
            <p class="product-desc">
              Matte-black coin with glow-green veins, built for night-mode wallets.
            </p>
            <p class="product-meta">Supply: 25,000 • Type: Night</p>
            <p class="product-price">3,500 GRUSH</p>
            <button class="btn-primary product-buy">Buy</button>
          </article>

          <!-- Epic -->
          <article class="product-card">
            <div class="product-badge epic">Epic</div>
            <h3 class="product-name">Crystallized Blaze Coin</h3>
            <p class="product-desc">
              Crystal-style translucent green core with metallic-silver lines.
            </p>
            <p class="product-meta">Supply: 5,000 • Type: Crystal</p>
            <p class="product-price">9,900 GRUSH</p>
            <button class="btn-primary product-buy">Buy</button>
          </article>

          <!-- Legendary -->
          <article class="product-card">
            <div class="product-badge legendary">Legendary</div>
            <h3 class="product-name">Royal Green Coin</h3>
            <p class="product-desc">
              Gold-silver hybrid coin with full detailed mascot engraving.
            </p>
            <p class="product-meta">Supply: 420 • Type: Crown</p>
            <p class="product-price">42,000 GRUSH</p>
            <button class="btn-primary product-buy">Buy</button>
          </article>
        </div>
      </section>
    </section>
  </main>

  <footer class="gr-footer">
    <span>© 2025 GREENRUSH</span>
    <span>Shop drops, not promises.</span>
  </footer>
  <div id="gr-toast" role="status" aria-live="polite">Copied contract</div>

  <!-- Solana web3 (IIFE) - provides `solanaWeb3` global -->
  <script src="https://unpkg.com/@solana/web3.js@1.79.0/lib/index.iife.min.js"></script>

  <script>
    // simple nav active state on click
    const links = document.querySelectorAll('.nav-link');
    links.forEach(link => {
      link.addEventListener('click', () => {
        links.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
      });
    });

    // copy-to-clipboard for contract address + toast
    const copyBtn = document.getElementById('gr-copy-btn');
    const contractEl = document.getElementById('gr-contract');
    const toast = document.getElementById('gr-toast');

    function showToast(text = 'Copied') {
      toast.textContent = text;
      toast.classList.add('show');
      clearTimeout(window.__gr_toast_timeout);
      window.__gr_toast_timeout = setTimeout(() => toast.classList.remove('show'), 1800);
    }

    if (copyBtn && contractEl && navigator.clipboard) {
      copyBtn.addEventListener('click', async () => {
        const txt = contractEl.textContent.trim();
        try {
          await navigator.clipboard.writeText(txt);
          showToast('Contract address copied');
        } catch (err) {
          // fallback: select + execCommand
          const range = document.createRange();
          range.selectNodeContents(contractEl);
          const sel = window.getSelection();
          sel.removeAllRanges();
          sel.addRange(range);
          try { document.execCommand('copy'); showToast('Copied to clipboard'); }
          catch (e) { showToast('Copy failed'); }
          sel.removeAllRanges();
        }
      });
    }

    // ===== Phantom wallet integration & simple buy flow =====
    // Note: This example sends SOL from the connected Phantom wallet
    // to a seller address. Token minting / automatic token transfer
    // requires a backend or on-chain program with mint authority.

    const connectBtn = document.getElementById('connect-wallet-btn');
    let provider = null;
    let walletPubkey = null;

    // Change to 'mainnet-beta' when ready for production.
    const SOLANA_NETWORK = 'devnet';
    const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl(SOLANA_NETWORK));

    // Replace with the seller's SOL address that receives payments
    const SELLER_ADDRESS = 'SELLER_SOL_ADDRESS_HERE';

    function getProvider() {
      // Phantom and many Solana wallets inject `window.solana`.
      // Return any available provider rather than only Phantom to improve compatibility.
      if (typeof window === 'undefined') return null;
      if (location && location.protocol === 'file:') {
        // Phantom extension does not inject into file:// pages.
        return null;
      }
      if (window.solana) return window.solana;
      if (window.phantom && window.phantom.solana) return window.phantom.solana;
      return null;
    }

    async function connectWallet() {
      provider = getProvider();
      if (!provider) {
        // Helpful guidance when provider isn't found
        if (location && location.protocol === 'file:') {
          alert('Wallet not detected. Serve this page over http(s) (for example: run a local web server on localhost) and ensure Phantom is installed. Phantom does not inject into file:// pages.');
        } else {
          const install = confirm('Phantom (or a Solana wallet) was not detected. Would you like to open the Phantom install page?');
          if (install) window.open('https://phantom.app/', '_blank');
        }
        return;
      }
      try {
        const resp = await provider.connect();
        walletPubkey = resp.publicKey;
        connectBtn.textContent = shortenAddress(walletPubkey.toString());
        connectBtn.classList.add('active');
        showToast('Wallet connected');
        await renderWalletPanel();
      } catch (err) {
        console.error('Connect failed', err);
      }
    }

    async function disconnectWallet() {
      if (provider) {
        try { await provider.disconnect(); } catch (e) { }
      }
      walletPubkey = null;
      connectBtn.textContent = 'Connect Wallet';
      connectBtn.classList.remove('active');
      await renderWalletPanel();
    }

    connectBtn.addEventListener('click', async () => {
      if (!walletPubkey) await connectWallet(); else await disconnectWallet();
    });

    function shortenAddress(addr) {
      return addr.slice(0,4) + '…' + addr.slice(-4);
    }

    // Insert a small wallet / buy panel into the Token Info section
    async function renderWalletPanel() {
      const tokenInfo = document.getElementById('token-info');
      if (!tokenInfo) return;

      // remove existing panel if present
      const existing = document.getElementById('gr-wallet-panel');
      if (existing) existing.remove();

      const panel = document.createElement('div');
      panel.id = 'gr-wallet-panel';
      panel.style.marginTop = '1rem';
      panel.innerHTML = `
        <div class="why-card" style="display:flex;flex-direction:column;gap:1rem; border-color:var(--accent-primary);">
          <div style="display:flex;justify-content:space-between;align-items:center; border-bottom:1px solid var(--border-light); padding-bottom:0.8rem;">
            <strong style="color:#fff;">Wallet Connected</strong>
            <span id="gr-wallet-addr" style="font-family:monospace; background:rgba(255,255,255,0.1); padding:0.2rem 0.6rem; border-radius:6px;">${walletPubkey ? shortenAddress(walletPubkey.toString()) : 'Not connected'}</span>
          </div>
          <div style="display:flex;gap:1rem;align-items:center; flex-wrap:wrap;">
            <div style="flex:1;">
              <label style="font-size:0.8rem; text-transform:uppercase; letter-spacing:0.05em; color:var(--text-muted); display:block; margin-bottom:0.4rem;">Amount (SOL)</label>
              <input id="gr-buy-amount" type="number" min="0.001" step="0.001" value="0.01" style="width:100%; padding:0.6rem; border-radius:8px; background:rgba(0,0,0,0.3); border:1px solid var(--border-light); color:#fff; font-family:inherit;">
            </div>
            <button id="gr-buy-btn" class="btn-primary" style="margin-top:1.4rem;">Buy Tokens</button>
          </div>
          <div id="gr-buy-status" style="font-size:0.85rem; color:var(--accent-primary); min-height:1.2em;"></div>
        </div>
      `;
      tokenInfo.appendChild(panel);

      const buyBtn = document.getElementById('gr-buy-btn');
      buyBtn.addEventListener('click', doBuy);
      await updateBalanceDisplay();
    }

    async function updateBalanceDisplay() {
      const addrEl = document.getElementById('gr-wallet-addr');
      if (!addrEl) return;
      if (!walletPubkey) { addrEl.textContent = 'Not connected'; return; }
      try {
        const bal = await connection.getBalance(walletPubkey);
        addrEl.textContent = `${shortenAddress(walletPubkey.toString())} — ${(bal/solanaWeb3.LAMPORTS_PER_SOL).toFixed(4)} SOL`;
      } catch (e) { addrEl.textContent = shortenAddress(walletPubkey.toString()); }
    }

    async function doBuy() {
      const status = document.getElementById('gr-buy-status');
      const amtEl = document.getElementById('gr-buy-amount');
      if (!walletPubkey) { alert('Connect your Phantom wallet first.'); return; }
      const solAmount = parseFloat(amtEl.value);
      if (!solAmount || solAmount <= 0) { alert('Enter a valid SOL amount.'); return; }
      status.textContent = 'Preparing transaction...';

      try {
        const sellerPub = new solanaWeb3.PublicKey(SELLER_ADDRESS);
        const lamports = Math.round(solAmount * solanaWeb3.LAMPORTS_PER_SOL);

        const transaction = new solanaWeb3.Transaction().add(
          solanaWeb3.SystemProgram.transfer({
            fromPubkey: walletPubkey,
            toPubkey: sellerPub,
            lamports
          })
        );

        transaction.feePayer = walletPubkey;
        const { blockhash } = await connection.getLatestBlockhash();
        transaction.recentBlockhash = blockhash;

        // Use Phantom's signAndSendTransaction API
        status.textContent = 'Requesting signature in Phantom...';
        const signed = await provider.signAndSendTransaction(transaction);
        const sig = signed.signature;
        status.textContent = `Transaction sent — signature: ${sig}. Waiting for confirmation...`;

        await connection.confirmTransaction(sig, 'confirmed');
        status.textContent = `Purchase complete — tx: ${sig}`;
        showToast('Purchase sent');

        // TODO: Notify backend (e.g., via fetch) to deliver/mint tokens to buyer.
      } catch (err) {
        console.error(err);
        status.textContent = 'Transaction failed or rejected.';
      }
    }

    // initialize panel if Phantom already connected
    (async () => {
      provider = getProvider();
      if (provider && provider.isConnected) {
        walletPubkey = provider.publicKey;
        connectBtn.textContent = shortenAddress(walletPubkey.toString());
        await renderWalletPanel();
      } else {
        await renderWalletPanel();
      }
    })();

  </script>
</body>
</html>
